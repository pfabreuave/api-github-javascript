<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" href="estilosa.css">
	<title>API GitHub</title>
	<script>
		const queryString = window.location.search;
		const urlParams = new URLSearchParams(queryString);
		const varUser = urlParams.get('user');
		//alert("User" + varUser);

	</script>
</head>
<body>
	<form>
				<div id="avatar"> 
					<img  class= imagen src ="img/DaniGoogle.png" alt='imagen Avatar'/>`
				</div>
				<h3 id=nombre ></h3>
				<h2 class="title">Repositorio do GitHub</h2>
					<input 
						type="text" 
						class="userInput" 
						id="usergh"				
						placeholder="Buscar usuario"
					/>
					<input 
						type="button"
						class="searchButton" 
						value="Buscar" 
						onclick="buscarGH()"
					/>			
	</form>
	<header>
		 <div class="img">
		 </div> 
		
		<div id="contenido"></div>
	</header>
	
	<div id="main">
		<table class="tabla" id="tabla">
			
			<tbody class="centrado">
		</table>
	</div>	

<script type="text/javascript">
	var j = 0;
	var i = 0;
	var cols = ['#AA55AA', //Violet Blue
				'#FF3030', //Red Orange
				'#ffff00', //Yellow
				'#3cff00', //Harlequin
				'#f8c046', 
				'#c39263', 
				'#006400', //Dark Green
				'#ff8000', //Dark Orange
				'#ff5050', //Sunset Orange
				'#905050', //grayish red
				'#401010'  //Seal Brown
			];

	function buscarGH() {
		contenido.innerHTML = ' '
		var usergh = document.getElementById("usergh");
		var urlu = "https://api.github.com/users/" + usergh.value;
		fetch(urlu, {method: 'GET'})
    		.then(function(response) {
        	if (!response.ok) {
            	throw Error(response.statusText);
        	}
        	return response.json();
    		})
			.then(function(users) {
				avatar.innerHTML +=`<img  class= imagen src =${users.avatar_url} alt='imagen Avatar'/>`
				nombre.innerHTML +=`<h3>  ${users.name} </h3>`	 	
				nombre.innerHTML +=`<h3>  ${users.public_repos} Repositorios publicos</h3>`	 	
    		})
			.catch(function(error) {
				avatar.innerHTML +=`<img  class=imgerr src='img/pare.jpg'>`
				nombre.innerHTML +=`<h3 class='title'>  Usuário ${usergh.value} não encontrado, por favor tente outro </h3>`	
    		});

		var url = "https://api.github.com/users/" + usergh.value + "/repos?per_page=100";
		fetch(url, {method: 'GET'})
			.then(function(response){
				return response.json()
			})
			.then(function(data){
				 var cont = 0
				 for(cont=0;cont<data.length;cont++){
					
					if (data[cont].homepage != null){
						i = j%10
						contenido.innerHTML +=` 
						<div class="card">
							<a href="${data[cont].homepage}" target="blank_"><img class=peq src="img/githubpages.png" alt=" "</a>
							<a href="${data[cont].html_url}" target="blank_">${data[cont].name}</a>
 						</div>`
						tabla.innerHTML +=` 
						<div class="campo_polo">
							<a href="${data[cont].homepage}" target="blank_" id="registro_${cont}" >
							   GitPage => ${data[cont].homepage} _STATUS = ${data[cont].has_pages}</a>
 						</div>`
						document.getElementById('registro_'+cont).style.backgroundColor=cols[i];
						 j++
					}
					else{
				 		contenido.innerHTML +=` 
						<div class="card">
							<a href="${data[cont].html_url}" target="blank_"> ${data[cont].name} </a>
 						</div>`
					}
					 
				}
			})
		avatar.innerHTML = ' '
		nombre.innerHTML = ' '
		tabla.innerHTML = ' '
	}
	  function actualizar(){location.reload(true);}

	  document.getElementById('usergh').value = varUser;
	 
	  if (varUser > " ") {
		buscarGH();
	  }
	 
</script>
</body>
</html>